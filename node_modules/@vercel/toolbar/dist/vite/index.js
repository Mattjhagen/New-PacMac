import{a as u}from"../chunk-QJ6Y4DYH.js";import{b as d}from"../chunk-XJSZYF63.js";import{c}from"../chunk-2NER6YV7.js";var o,i;function l(e){typeof window>"u"||typeof EventSource>"u"||!e||i||(i=e,o=new EventSource(`${e}/events`),f(),window.addEventListener("vercel-toolbar-ready",()=>{f()}))}function f(){let e=d();e?.isAuthenticated&&e.setLocalhostEventSource?.({subscribe:s,fetchLocal:v})}function s(e,n){if(!o)return()=>{};let r=t=>{try{let a=t.data&&typeof t.data=="string"?JSON.parse(t.data):void 0;a&&n(a)}catch{}};return o.addEventListener(e,r),()=>{o?.removeEventListener(e,r)}}async function v(e,n){if(!i)return{error:"No toolbar server"};try{let r=await fetch(`${i}${e}`,n?{method:"POST",body:JSON.stringify(n)}:void 0),t=await r.json();return r.ok?{result:t}:{error:t.error}}catch(r){return{error:`${r}`}}}function m(){s("branch-change",e=>{e&&location.reload()})}function S({nonce:e}={}){let n=u({branch:import.meta.env.VERCEL_TOOLBAR_BRANCH,ownerId:import.meta.env.VERCEL_TOOLBAR_OWNER_ID,projectId:import.meta.env.VERCEL_TOOLBAR_PROJECT_ID,deploymentId:import.meta.env.VERCEL_TOOLBAR_DEPLOYMENT_ID,nonce:e});return import.meta.env.DEV&&(c()?p():console.log(`
      You are rendering the Vercel Toolbar in development, but the configuration is missing.
      Make sure the plugin is added to the Vite config and the project has been linked using \`vercel link\`.
      For more details, visit https://vercel.com/docs/workflow-collaboration/vercel-toolbar/in-production-and-localhost/add-to-localhost
      `.trim())),n}function p(){l(import.meta.env.VERCEL_TOOLBAR_SERVER),m()}export{S as mountVercelToolbar};
